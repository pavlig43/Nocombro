# Правило: Выбор места выполнения задач

## Принцип
Перед началом выполнения любой задачи, которая затрагивает кодовую базу, **всегда** спрашивай у пользователя, где выполнять эту задачу.

## Когда применять правило
Применяется для **любых** задач, которые:
- Меняют код (refactoring, new features, bug fixes)
- Требуют создания/изменения файлов
- Влияют на структуру проекта
- Требуют тестирования изменений

**НЕ применяется** для:
- Ответов на вопросы
- Анализа кода (read-only операции)
- Объяснений и документации

## Варианты выполнения

### 1. Текущая директория и ветка
**Когда использовать:**
- Маленькие правки (bug fixes, typo fixes)
- Эксперименты
- Задачи, не требующие отдельной ветки

**Команды:**
```bash
# Работаем в текущей ветке
git status
```

### 2. Новая ветка (feature branch)
**Когда использовать:**
- Новые функции
- Рефакторинг
- Средние и большие задачи
- Подготовка к PR

**Команды:**
```bash
# Создаём новую ветку от текущей
git checkout -b feature/название-ветки
```

### 3. Git Worktree (РЕКОМЕНДУЕТСЯ ПО УМОЛЧАНИЮ)
**Когда использовать:**
- **Большинство задач по умолчанию** — сохраняет текущую работу изолированно
- Нужно работать над несколькими задачами параллельно
- Хочется сохранить текущее состояние нетронутым
- Большая задача, требующая отдельного пространства
- Текущая ветка имеет незавершённые изменения

**Команды:**
```bash
# Создаём worktree для новой ветки
git worktree add -b feature/название-ветки ../path-to-worktree

# Или в существующую директории проекта
git worktree add -b feature/название-ветки ../Nocombro-название

# После работы удаляем worktree
git worktree remove ../path-to-worktree

# Список всех worktree
git worktree list

# Очистка удалённых веток
git worktree prune
```

**Просмотр существующих worktree:**
```bash
# Показать все worktree
git worktree list

# Переключиться на работу в другом worktree
cd ../Nocombro-другая-задача
```

### 4. Временная ветка (draft/spike)
**Когда использовать:**
- Исследования (spikes)
- Эксперименты с кодом
- Незавершённые работы

**Команды:**
```bash
git checkout -b draft/название-ветки
```

### 5. Fork проекта (для внешних的贡献)
**Когда использовать:**
- Работа над open-source проектом
- Нужно отправить PR в другой репозиторий

## Процесс выбора

Всегда начинай задачу с вопроса пользователю:

```
> Для этой задачи есть несколько вариантов выполнения:

1. **Текущая ветка** — для быстрых правок
2. **Новая ветка** — для features/bugfixes (рекомендуется)
3. **Git Worktree** — для параллельной работы
4. **Временная ветка** — для экспериментов

Где выполнить задачу?
```

### Решающие факторы для рекомендации

| Ситуация | Рекомендация |
|----------|--------------|
| New feature | **Worktree** (лучше изоляция) или новая ветка |
| Bug fix | **Worktree** или новая ветка |
| Refactoring | **Worktree** или новая ветка |
| Typo fix | Текущая ветка |
| Эксперимент | **Worktree** или временная ветка |
| Несколько задач одновременно | **Worktree** (обязательно) |
| Текущая ветка "грязная" | **Worktree** (обязательно) |

## Пример диалога

```
Пользователь: Добавить форму авторизации

Claude: Для этой задачи есть несколько вариантов:

1. **Текущая ветка** — для быстрых правок
2. **Новая ветка** — для features (рекомендуется)
3. **Git Worktree** — для параллельной работы

Рекомендую создать новую ветку `feature/auth-form`.
Где выполнить задачу?

Пользователь: Новая ветка

Claude: Создаю ветку feature/auth-form...

[выполнение задачи]
```

## ВАЖНО
- **Всегда** спрашивай перед началом работы
- **Рекомендуй** подходящий вариант на основе типа задачи
- **Применял правило** даже если кажется, что задача "маленькая"
- **Действуй** только после получения ответа пользователя
